<script>

function AmplitudeFX() {

}

function Transform() {
	this.rawAmplitude = 1;
	this.amplitudeFX = [];
}

Transform.prototype.get = function() {
	return this.rawAmplitude;
}

function generateSquareWave(audivi, buffer, frequency, time, transform) {
	var samplesPerSecond = audivi.audioContext.sampleRate;
	var samples = time * samplesPerSecond;
	var wavelength = (samplesPerSecond / frequency);

	for(var i = 0; i < samples; ++i) {
		buffer[i] = ((i % wavelength) > (wavelength / 2) ? 0 : 1) * transform.get();
	}
}

function generateSineWave(audivi, buffer, frequency, time, transform) {
	var samplesPerSecond = audivi.audioContext.sampleRate;
	var samples = time * samplesPerSecond;

	for(var i = 0; i < samples; ++i) {
		buffer[i] = (Math.sin(i / (samplesPerSecond / 2 / Math.PI / frequency))) * transform.get();
	}
}

function generateTriangleWave(audivi, buffer, frequency, time, transform) {
	var samplesPerSecond = audivi.audioContext.sampleRate;
	var samples = time * samplesPerSecond;
	var wavelength = (samplesPerSecond / frequency);

	for(var i = 0; i < samples; ++i) {
		buffer[i] = ((i % wavelength) > (wavelength / 2) ? 1 - ((i % wavelength) - (wavelength / 2)) / (wavelength / 2) : (i % wavelength) / (wavelength / 2)) * transform.get();
	}
}

function generateSawtoothWave(audivi, buffer, frequency, time, transform) {
	var samplesPerSecond = audivi.audioContext.sampleRate;
	var samples = time * samplesPerSecond;
	var wavelength = (samplesPerSecond / frequency);

	for(var i = 0; i < samples; ++i) {
		buffer[i] = (-1 + 2 * ( (i % wavelength) / wavelength)) * transform.get();
	}
}

function Audivi() {
	this.audioContext = new AudioContext();
}

Audivi.prototype.createBuffer = function() {
	return this.audioContext.createBuffer(1, this.audioContext.sampleRate, this.audioContext.sampleRate);
}

Audivi.prototype.play = function(time, buffer) {
	var source = this.audioContext.createBufferSource();
	source.buffer = buffer;
	source.connect(this.audioContext.destination);
	source.start(time);
}

var audivi = new Audivi();

var buffer = audivi.createBuffer();

var transform = new Transform();
transform.rawAmplitude = 0.1;

generateSawtoothWave(audivi, buffer.getChannelData(0), 440, 5, transform);

audivi.play(0, buffer);
</script>